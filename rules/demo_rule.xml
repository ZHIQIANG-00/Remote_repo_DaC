<!-- Demo Rules -->
<!-- Copyright (C) 2015, Wazuh Inc. -->

<!-- 
  Rules detect suspicious activity based on log patterns.
  This rule triggers on multiple failed SSH authentication attempts.
-->

<group name="demo,syslog,sshd,">

  <!-- Rule that links to an existing parent rule 
  Rule 100010: Detects SSH failures from internal network (links to existing rule 5716)-->
  <rule id="100010" level="6">
    <if_sid>5716</if_sid>
    <srcip>192.168.1.0/24</srcip>
    <description>SSH: Failed authentication from internal network</description>
    <group>authentication_failed,demo_rules,</group>
  </rule>

  <!-- Standalone rule with custom matching 
  Rule 100011: Detects root login failures specifically-->
  <rule id="100011" level="7">
    <decoded_as>demo_auth_decoder</decoded_as>
    <field name="action">Failed</field>
    <field name="user">root</field>
    <description>SSH: Root login attempt failed</description>
    <group>authentication_failed,privilege_escalation,demo_rules,</group>
  </rule>

  <!-- Rule for JSON-based custom application 
  Rule 100012: Detects login failures in custom JSON applications-->
  <rule id="100012" level="5">
    <decoded_as>demo_json_decoder</decoded_as>
    <field name="event_type">user_login</field>
    <field name="status">failed</field>
    <description>Custom app: User login failed</description>
    <group>authentication_failed,demo_rules,</group>
  </rule>

</group>

